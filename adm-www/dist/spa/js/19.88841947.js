(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[19],{"67cc":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("q-page",{},[a("div",{staticClass:"row doc-header",class:e.$q.platform.is.mobile?"":"q-pa-lg"},[a("div",{staticClass:"col-sm-12"},[a("q-table",{attrs:{data:e.rows,columns:e.columns,dense:"",loading:e.loading,"rows-per-page-options":e.$qtable.rowsperpageoptions,pagination:e.dataset.pagination,"row-key":"id",filter:e.filter},on:{"update:pagination":function(t){return e.$set(e.dataset,"pagination",t)},request:e.refreshData},scopedSlots:e._u([{key:"top-right",fn:function(){return[a("q-btn",{staticClass:"q-mr-sm",attrs:{color:"black",outline:"",label:"adicionar"},on:{click:e.actNewDialog}}),a("q-input",{attrs:{outlined:"",dense:"",debounce:"300",placeholder:"Procurar",loading:e.loading},scopedSlots:e._u([{key:"append",fn:function(){return[a("q-checkbox",{attrs:{color:"red"},model:{value:e.dataset.showall,callback:function(t){e.$set(e.dataset,"showall",t)},expression:"dataset.showall"}},[a("q-tooltip",{attrs:{delay:700}},[a("div",{staticClass:"text-weight-bold"},[e._v("Mostrar todos")]),a("div",[e._v("Se marcado essa opção mostra todos os usuários ativos e inativos")]),a("div",[e._v("Se desmarcado mostra somente usuários ativos")])])],1),e.loading?e._e():a("q-icon",{attrs:{name:"sync"},on:{click:function(t){return e.refreshData(null)}}})]},proxy:!0}]),model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}})]},proxy:!0},{key:"body-cell-action",fn:function(t){return[a("q-td",{attrs:{props:t}},[a("q-btn",{attrs:{flat:"",round:"",dense:"",size:e.$q.platform.is.mobile?"12px":"10px",icon:"edit",color:"grey-9"},on:{click:function(a){return e.actEditUsuario(t.row)}}})],1)]}},{key:"body-cell-permissao",fn:function(t){return[a("q-td",{class:t.row.ativo?"":"bg-red-1 text-red",attrs:{props:t}},[a("q-avatar",{staticClass:"q-mr-sm",attrs:{size:"24px","font-size":"18px",color:t.row.pemitefup?"blue":"red-3","text-color":"white",icon:"insights"}},[a("q-tooltip",{attrs:{delay:500}},[e._v('Permissão de "Ver FUP" :: '+e._s(t.row.pemitefup?"Liberada":"Bloqueado")+" ")])],1),a("q-avatar",{staticClass:"q-mr-sm",attrs:{size:"24px","font-size":"18px","text-color":"white",icon:"receipt_long",color:t.row.permitecoletasver?"blue":"red-3"}},[a("q-tooltip",{attrs:{delay:500}},[e._v('Permissão de "Ver Coletas" :: '+e._s(t.row.permitecoletasver?"Liberada":"Bloqueado")+" ")])],1),a("q-avatar",{attrs:{size:"24px","font-size":"18px","text-color":"white",icon:"dashboard",color:t.row.permitestatusgeral?"blue":"red-3"}},[a("q-tooltip",{attrs:{delay:500}},[e._v('Permissão de "Ver Status Geral" :: '+e._s(t.row.permitestatusgeral?"Liberada":"Bloqueado")+" ")])],1)],1)]}},{key:"body-cell-ultimoacesso",fn:function(t){return[a("q-td",{attrs:{props:t}},[t.row.ultimoacesso?a("div",[e._v(e._s(e.$helpers.datetimeRelativeToday(t.row.ultimoacesso))+"\n                "),a("q-tooltip",[a("div",[e._v("Último acesso em  "+e._s(e.$helpers.datetimeToBR(t.row.ultimoacesso)))])])],1):a("div",{staticClass:"text-blue"},[e._v("\n                Nunca acessou!\n              ")])])]}},{key:"body-cell-createdat",fn:function(t){return[a("q-td",{attrs:{props:t}},[t.row.created_usuario?a("div",[e._v("\n                "+e._s(t.row.created_usuario?t.row.created_usuario.nome:"Não identificado")+" - "+e._s(e.$helpers.datetimeRelativeToday(t.row.created_at))+"\n                "),a("q-tooltip",[a("div",[e._v("Adicionado por  "+e._s(t.row.created_usuario?t.row.created_usuario.nome:"Não identificado"))]),a("div",[e._v("em  "+e._s(e.$helpers.datetimeToBR(t.row.created_at)))])])],1):e._e()])]}},{key:"body-cell-ativo",fn:function(t){return[a("q-td",{attrs:{props:t}},[a("span",{class:t.row.ativo?"":"text-red text-weight-bold"},[e._v(e._s(t.row.ativo?"Ativo":"Inativo"))])])]}}])})],1)]),a("q-page-sticky",{attrs:{position:"top",expand:""}},[a("q-toolbar",{staticClass:"bg-white text-primary shadow-up-21"},[a("q-btn",{attrs:{flat:"",dense:"",round:"","aria-label":"Menu",icon:"menu"},on:{click:function(t){return e.$store.dispatch("homedashboard/togglemenu")}}}),a("q-btn",{attrs:{flat:"",round:"",icon:"arrow_back"},on:{click:function(t){return e.$router.go(-1)}}}),e.$q.platform.is.mobile?e._e():a("q-separator",{attrs:{vertical:"",inset:"",spaced:""}}),a("q-toolbar-title",[e._v("Gestão de Usuários")]),a("q-btn",{attrs:{icon:"sync",label:e.$q.platform.is.mobile?"":"Atualizar",round:e.$q.platform.is.mobile,flat:"",loading:e.loading},on:{click:function(t){return e.refreshData(null)}}})],1)],1)],1)],1)},n=[],o=(a("ac6a"),a("cadf"),a("06db"),a("456d"),a("7f7f"),a("a34a")),s=a.n(o),i=(a("96cf"),a("c973")),l=a.n(i),c=a("970b"),u=a.n(c),d=a("5bc3"),p=a.n(d),f=a("2b0e"),h=a("8002"),m=function(){function e(){u()(this,e),this.limpardados(),this.pagination={page:1,rowsPerPage:20,sortBy:"nome",descending:!1,rowsNumber:0},this.showall=!1}return p()(e,[{key:"limpardados",value:function(){var e=l()(s.a.mark((function e(){return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.itens=null;case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"readPropsTable",value:function(e){if(e){var t=e.pagination,a=t.page,r=t.rowsPerPage,n=t.sortBy,o=t.descending,s=t.rowsNumber,i=e.filter;this.filter!==i&&(this.page=1),this.pagination={page:a,rowsPerPage:r,sortBy:n,descending:o,rowsNumber:s},this.filter=i}}},{key:"loadmore",value:function(){var e=l()(s.a.mark((function e(){var t;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.pagination.page=parseInt(this.pagination.page)+1,e.next=3,this.fetch(!0);case 3:return t=e.sent,e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"fetchPorCliente",value:function(){var e=l()(s.a.mark((function e(t){var a,r,n;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=this,a.limpardados(),r={showall:a.showall?1:0},"undefined"!==typeof t&&t>0&&(r.clienteid=t),e.next=6,f["a"].prototype.$axios.get("/v1/painelcliente/usuarios",{params:r}).then((function(e){var t=e.data,r={ok:!1,msg:""};if(t&&(r.msg=t.msg?t.msg:"",t.ok)){t=t.data,a.total=t.total?parseInt(t.total):0,a.pagination.page=t.current_page,a.pagination.rowsPerPage=parseInt(t.per_page),a.pagination.sortBy=t.sortby?t.sortby:"",a.pagination.descending="desc"===t.descending,a.pagination.rowsNumber=t.total?parseInt(t.total):0,r.ok=!0,a.itens||(a.itens=[]);for(var n=0;n<t.rows.length;n++){var o=t.rows[n],s=new h["a"](o);s.id>0&&a.itens.push(s)}}return r})).catch((function(e){return f["a"].prototype.$helpers.errorReturn(e)}));case 6:return n=e.sent,e.abrupt("return",n);case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}]),e}(),g=m,w=a("4e72"),b={name:"cadastro.clientes.usuario",components:{},data:function(){var e=new g;return{dataset:e,permiteusuariosconsultar:null,permiteusuariosgerenciar:null,orderbylist:{nome:"asc"},error:null,rows:[],filter:"",columns:[{name:"action",style:"width: 30px",align:"left",label:"",field:"id",sortable:!1},{name:"nome",align:"left",label:"Nome",field:"nome",sortable:!1},{name:"ativo",align:"center",label:"Status",field:"ativo",sortable:!1},{name:"permissao",align:"center",label:"Permissões",field:"permissao",sortable:!1},{name:"email",align:"left",label:"E-mail",field:"email",sortable:!1,filterconfig:{value:null,sorted:!0}},{name:"ultimoacesso",style:"width: 220px",align:"left",label:"Último acesso",field:"ultimoacesso",sortable:!1},{name:"id",style:"width: 30px",align:"center",label:"ID",field:"id",sortable:!1}],loading:!1,posting:!1,msgError:""}},mounted:function(){var e=this;return l()(s.a.mark((function t(){var a;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e,e.permiteusuariosconsultar=e.$helpers.permite("cadastros.clientes.usuarios.consultar"),e.permiteusuariosgerenciar=e.$helpers.permite("cadastros.clientes.usuarios.gerenciar"),!a.$route.query){t.next=6;break}return t.next=6,a.queryRead();case 6:return t.next=8,a.refreshData(null);case 8:case"end":return t.stop()}}),t)})))()},methods:{actEditUsuario:function(e){var t=this;return l()(s.a.mark((function a(){var r,n,o;return s.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=t,a.next=3,e.ShowDialogEdit(r);case 3:if(n=a.sent,n.ok){a.next=10;break}return o=r.$helpers.showDialog(n),a.next=8,o.then((function(){}));case 8:a.next=11;break;case 10:r.refreshData();case 11:case"end":return a.stop()}}),a)})))()},actDelete:function(e){var t=this;return l()(s.a.mark((function a(){var r,n;return s.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=t,n=e.deleteWithQuestion(r),a.next=4,n.then((function(e){e.ok?(r.$q.notify({message:"Cliente excluído",color:"positive",caption:e.msg,actions:[{label:"OK",color:"white",handler:function(){}}]}),r.refreshData(null)):e.msg&&""!==e.msg&&r.$helpers.showDialog(e)}));case 4:case"end":return a.stop()}}),a)})))()},actEditDialog:function(e){var t=this;return l()(s.a.mark((function a(){var r,n,o,i;return s.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=t,n=r.rows[e],a.next=4,n.dialogAddOrEdit(r);case 4:if(o=a.sent,!o.ok){a.next=9;break}r.refreshData(null),a.next=13;break;case 9:if(!o.msg||""===o.msg){a.next=13;break}return i=r.$helpers.showDialog(o),a.next=13,i.then((function(){}));case 13:case"end":return a.stop()}}),a)})))()},actShowUsuarioAddOrEdit:function(e){var t=this;return l()(s.a.mark((function a(){var r,n,o;return s.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=t,a.next=3,e.ShowDialogUsuarioGestao(r);case 3:if(n=a.sent,!n.ok){a.next=8;break}r.refreshData(null),a.next=12;break;case 8:if(!n.msg||""===n.msg){a.next=12;break}return o=r.$helpers.showDialog(n),a.next=12,o.then((function(){}));case 12:case"end":return a.stop()}}),a)})))()},actInputFilter:function(){var e=this;e.loading||e.refreshData(null)},actShowFilter:function(e){var t=arguments,a=this;return l()(s.a.mark((function r(){var n,o,i,l;return s.a.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(n=t.length>1&&void 0!==t[1]?t[1]:-1,o=a,o.showfilteridx=n,!e){r.next=13;break}i=0;case 5:if(!(i<o.columns.length)){r.next=13;break}if(l=o.columns[i],l.name!==e.col.name){r.next=10;break}return o.showfilteridx=i,r.abrupt("break",13);case 10:i++,r.next=5;break;case 13:a.showfilter=!0;case 14:case"end":return r.stop()}}),r)})))()},actChangeSortBy:function(e){var t=this;if(e){for(var a=-1,r=0;r<t.columns.length;r++){var n=t.columns[r];if(n.name===e.name){a=r;break}}if(a>=0&&t.columns[a].filterconfig.sorted){var o=t.columns[a].name,s=t.orderbylist[o];s=s&&"asc"===s?"desc":"asc",t.orderbylist={},t.orderbylist[o]=s}}t.refreshData(null)},queryRead:function(){var e=this;return l()(s.a.mark((function t(){var a,r,n,o,i,l;return s.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e,r=a.$route.query,r)for(r.pagesize&&(n=parseInt(r.pagesize),a.$qtable.rowsperpageoptions.indexOf(n)>=0&&(a.dataset.pagination.rowsPerPage=n)),r.page&&(a.dataset.pagination.page=parseInt(r.page)),o=null,r.sortby&&(o=JSON.parse(r.sortby),Object.keys(o).length>0&&(a.orderbylist=o)),i=0;i<a.columns.length;i++)l=a.columns[i],l.filterconfig&&r[l.name]&&(l.filterconfig.value=r[l.name]);case 3:case"end":return t.stop()}}),t)})))()},actNewDialog:function(e){var t=this;return l()(s.a.mark((function e(){var a,r,n,o;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=t,r=new w["a"],e.next=4,r.dialogAddOrEdit(a);case 4:if(n=e.sent,!n.ok){e.next=10;break}return e.next=8,a.refreshData(null);case 8:e.next=14;break;case 10:if(!n.msg||""===n.msg){e.next=14;break}return o=a.$helpers.showDialog(n),e.next=14,o.then((function(){}));case 14:case"end":return e.stop()}}),e)})))()},refreshData:function(e){var t=this;return l()(s.a.mark((function a(){var r,n,o,i,l,c;return s.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:for(r=t,r.loading=!0,r.msgError="",r.dataset.readPropsTable(e),r.dataset.params={},n=0;n<r.columns.length;n++)o=r.columns[n],o.filterconfig&&null!==o.filterconfig.value&&void 0!==o.filterconfig.value&&""!==o.filterconfig.value&&(r.dataset.params[o.name]=o.filterconfig.value);return r.dataset.orderby=null,r.orderbylist&&(i=Object.keys(r.orderbylist).length,i>0&&(r.dataset.orderby=r.orderbylist)),a.next=10,r.dataset.fetchPorCliente(-1);case 10:if(l=a.sent,!l.ok){a.next=16;break}r.rows=r.dataset.itens,a.next=19;break;case 16:return c=r.$helpers.showDialog(l),a.next=19,c.then((function(){}));case 19:r.loading=!1;case 20:case"end":return a.stop()}}),a)})))()}}},v=b,x=a("2877"),k=a("9989"),y=a("eaac"),q=a("9c40"),_=a("27f9"),$=a("8f8e"),D=a("05c0"),P=a("0016"),C=a("db86"),Q=a("cb32"),S=a("de5e"),T=a("65c6"),B=a("eb85"),E=a("6ac5"),I=a("eebe"),N=a.n(I),z=Object(x["a"])(v,r,n,!1,null,null,null);t["default"]=z.exports;N()(z,"components",{QPage:k["a"],QTable:y["a"],QBtn:q["a"],QInput:_["a"],QCheckbox:$["a"],QTooltip:D["a"],QIcon:P["a"],QTd:C["a"],QAvatar:Q["a"],QPageSticky:S["a"],QToolbar:T["a"],QSeparator:B["a"],QToolbarTitle:E["a"]})}}]);