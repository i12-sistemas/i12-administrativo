(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[16],{d7a0:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-card",{staticClass:"full-width",attrs:{flat:""}},[r("q-card-section",[r("q-input",{ref:"txtuser",attrs:{outlined:"",color:"primary","bg-color":"white","label-color":"grey-10",loading:e.sending,disable:e.sending,label:"Usuário",type:"email",maxlength:"255",hint:"Informe o nome de usuário",counter:""},on:{keyup:function(t){return t.type.indexOf("key")||13===t.keyCode?e.actRequest(t):null}},scopedSlots:e._u([{key:"prepend",fn:function(){return[r("q-icon",{attrs:{name:"person"}})]},proxy:!0}]),model:{value:e.username,callback:function(t){e.username=t},expression:"username"}})],1),r("q-card-section",[r("q-input",{ref:"txtpwd",attrs:{outlined:"",color:"primary","bg-color":"white","label-color":"grey-10",loading:e.sending,disable:e.sending,label:"Senha",type:"password"},on:{keyup:function(t){return t.type.indexOf("key")||13===t.keyCode?e.actRequest(t):null}},scopedSlots:e._u([{key:"prepend",fn:function(){return[r("q-icon",{attrs:{name:"lock"}})]},proxy:!0}]),model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1),e.recaptchasitekey&&""!==e.recaptchasitekey?r("q-card-section",{staticClass:"text-center q-py-md"},[r("div",{staticClass:"full-width row justify-center items-center"},[e.recaptchaloading?r("div",[e._v("carregando...")]):e._e(),r("vue-recaptcha",{ref:"recaptcha",attrs:{sitekey:e.recaptchasitekey,loadRecaptchaScript:!0},on:{verify:e.verify,render:e.rendered}})],1)]):e._e(),r("q-card-actions",{staticClass:"row wrap justify-between q-px-md content-start",attrs:{align:"center"}},[r("q-btn",{staticClass:"full-width q-py-sm",attrs:{unelevated:"","text-color":"white",icon:"far fa-keyboard",label:"Acessar",loading:e.sending,color:"primary"},on:{click:e.actRequest}})],1),r("q-card-section",[r("p",{staticClass:"text-caption text-center"},[e._v("\n      Seu IP esta sendo registrado!\n    ")])])],1)},a=[],s=(r("8e6e"),r("8a81"),r("ac6a"),r("cadf"),r("456d"),r("6b54"),r("06db"),r("9523")),c=r.n(s),o=r("a34a"),i=r.n(o),u=(r("96cf"),r("c973")),p=r.n(u),l=r("e096"),d=r("2f62"),f=r("bc3a"),h=r.n(f);function w(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?w(Object(r),!0).forEach((function(t){c()(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):w(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var k={data:function(){return{username:"",password:"",recaptchaloading:!0,recaptchatoken:null,recaptchasitekey:null,sending:!1,redirect:null}},components:{VueRecaptcha:l["a"]},computed:{allowpost:function(){var e=this,t=!0;try{if(e.sending)throw new Error("Em loading");if(!e.username||""===e.username)throw new Error("username inválido");if(!e.password||""===e.password)throw new Error("password inválido");if(e.recaptchasitekey&&""!==e.recaptchasitekey&&!e.recaptchatoken)throw new Error("Sem recaptcha nota")}catch(r){t=!1}return t}},mounted:function(){var e=this;return p()(i.a.mark((function t(){var r;return i.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=e,r.recaptchasitekey=r.$configini.RECAPTCHA_KEY?r.$configini.RECAPTCHA_KEY:null,r.recaptchasitekey&&""!==r.recaptchasitekey||(r.recaptchasitekey=null),r.$route.query&&r.$route.query.redirect&&(r.redirect=r.$route.query.redirect),r.$store.state.usuario.logado&&r.redirectNow(),r.$nextTick((function(){r.$refs.txtuser.$el.focus()}));case 6:case"end":return t.stop()}}),t)})))()},methods:m(m({},Object(d["b"])("authmotorista",["logout"])),{},{redirectNow:function(){var e=this;return p()(i.a.mark((function t(){var r;return i.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=e,!r.redirect){t.next=6;break}return t.next=4,r.$router.push({path:r.redirect});case 4:t.next=8;break;case 6:return t.next=8,r.$router.push({name:"home"});case 8:case"end":return t.stop()}}),t)})))()},rendered:function(e){this.recaptchaloading=!1},verify:function(e){var t=this;return p()(i.a.mark((function r(){return i.a.wrap((function(r){while(1)switch(r.prev=r.next){case 0:t.recaptchatoken=e;case 1:case"end":return r.stop()}}),r)})))()},closeApp:function(){return p()(i.a.mark((function e(){return i.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:navigator.app.exitApp();case 1:case"end":return e.stop()}}),e)})))()},actRequest:function(e){var t=this;return p()(i.a.mark((function e(){var r,n;return i.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(r=t,""!==r.username){e.next=4;break}return r.$refs.txtuser.$el.focus(),e.abrupt("return");case 4:if(""!==r.password){e.next=7;break}return r.$refs.txtpwd.$el.focus(),e.abrupt("return");case 7:if(r.allowpost){e.next=9;break}return e.abrupt("return");case 9:return r.sending=!0,e.next=12,r.sendRequest();case 12:n=e.sent,n.ok||(r.recaptchatoken=null,r.recaptchasitekey&&""!==r.recaptchasitekey&&r.$refs.recaptcha.reset(),r.actShowError("Acesso restrito",n.msg,4e3)),r.sending=!1;case 15:case"end":return e.stop()}}),e)})))()},actShowError:function(e,t,r){var n=this,a=n.$q.dialog({title:e,message:t}).onDismiss((function(){clearTimeout(s),n.username="",n.password="",n.$nextTick((function(){n.$refs.txtuser.$el.focus()}))})),s=setTimeout((function(){a.hide()}),r)},sendRequest:function(){var e=this;return p()(i.a.mark((function t(){var r,n,a,s,c;return i.a.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=e,t.prev=1,""!==r.username){t.next=5;break}throw e.$refs.txtuser.$el.focus(),new Error("Usuário inválido");case 5:if(""!==r.password){t.next=8;break}throw e.$refs.txtpwd.$el.focus(),new Error("Senha inválida");case 8:if(r.username=r.username.toString().trim(),!(r.username.length<=1)){t.next=11;break}throw new Error("Usuário inválido");case 11:t.next=16;break;case 13:return t.prev=13,t.t0=t["catch"](1),t.abrupt("return",{ok:!1,msg:t.t0.message});case 16:return n={},r.recaptchasitekey&&""!==r.recaptchasitekey&&(n["g-recaptcha-response"]=r.recaptchatoken),a="Basic "+btoa(r.username+":"+r.password),s=h.a.create({baseURL:r.$configini.API_URL,withCredentials:!1,headers:{Authorization:a,"Access-Control-Allow-Origin":"*","Access-Control-Allow-Headers":"Authorization","Access-Control-Allow-Methods":"GET, POST, OPTIONS, PUT, PATCH, DELETE","Content-Type":"application/json;charset=UTF-8"}}),t.next=22,s.post("v1/auth",n).then((function(e){var t=e.data;return t})).catch((function(e){var t=e;return t=e.response?"Code: "+e.response.status+" - "+e.response.data.message:e.message,{ok:!1,msg:"Falha ao consultar servidor online: "+t}}));case 22:if(c=t.sent,!c.ok){t.next=27;break}return t.next=26,r.$store.dispatch("usuario/auth",c.data);case 26:r.$store.state.usuario.logado&&r.redirectNow();case 27:return t.abrupt("return",c);case 28:case"end":return t.stop()}}),t,null,[[1,13]])})))()}})},y=k,b=r("2877"),g=r("f09f"),v=r("a370"),x=r("27f9"),$=r("0016"),O=r("4b7e"),q=r("9c40"),C=r("eebe"),E=r.n(C),A=Object(b["a"])(y,n,a,!1,null,null,null);t["default"]=A.exports;E()(A,"components",{QCard:g["a"],QCardSection:v["a"],QInput:x["a"],QIcon:$["a"],QCardActions:O["a"],QBtn:q["a"]})}}]);