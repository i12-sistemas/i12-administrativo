(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[26],{"0878":function(t,a,e){"use strict";e.r(a);var r=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",[e("q-page",{},[e("div",{staticClass:"row doc-page",class:t.$q.platform.is.mobile?"q-pa-0":"q-pa-md"},[t.error?e("div",{staticClass:"col-12"},[e("q-banner",{staticClass:"bg-negative text-white"},[t._v(t._s(t.error))])],1):t._e(),t.error?t._e():e("div",{staticClass:"col-sm-12 full-width"},[e("q-card",{staticClass:"bg-white",attrs:{bordered:!t.$q.platform.is.mobile,square:t.$q.platform.is.mobile,flat:""}},[t.consultando?e("q-card-section",{staticClass:"full-width text-center justify-center items-center q-ma-lg"},[e("div",{staticStyle:{"max-width":"15rem",margin:"0 auto"}},[e("lottie-animation",{attrs:{animationData:t.lottiessearchdoc,speed:1,loop:!0,autoPlay:""}})],1)]):t._e(),e("q-card-section",[e("q-option-group",{attrs:{type:"radio",options:[{label:"Por chave da NF-e",value:"chave"},{label:"Número NF-e",value:"numero"},{label:"Número da coleta",value:"coleta"}],inline:"",disable:t.consultando},model:{value:t.consultatipo,callback:function(a){t.consultatipo=a},expression:"consultatipo"}})],1),"chave"===t.consultatipo?e("q-card-section",{staticClass:"q-py-xs"},[e("q-input",{ref:"txtchave",attrs:{outlined:"",label:"Chave da nota*","stack-label":"",maxlength:"44",counter:"","input-class":"text-weight-bold",disable:t.consultando,"error-message":t.consultanferet.msg,error:!!t.consultanferet&&(!t.consultanferet.ok&&""!==t.consultanferet.msg)&&!!t.consultachave&&t.consultachave.length>0},on:{input:t.onInputChave},scopedSlots:t._u([{key:"append",fn:function(){return[t.consultanferet&&t.consultanferet.ok&&t.consultachave&&t.consultachave.length>0?e("q-icon",{attrs:{name:"check_circle",color:"positive",size:"md"}}):t._e()]},proxy:!0}],null,!1,3022552354),model:{value:t.consultachave,callback:function(a){t.consultachave=a},expression:"consultachave"}})],1):t._e(),"numero"===t.consultatipo||"coleta"===t.consultatipo?e("q-card-section",{staticClass:"q-py-xs"},[e("q-input",{attrs:{outlined:"",label:"numero"===t.consultatipo?"Número da nota fiscal":"Número da coleta","stack-label":"",type:"number",disable:t.consultando,min:"1",mask:"9999999999","input-class":"text-weight-bold"},model:{value:t.consultanumero,callback:function(a){t.consultanumero=a},expression:"consultanumero"}})],1):t._e(),e("q-card-section",[e("q-btn",{class:t.$q.platform.is.mobile?"full-width q-py-md":"",attrs:{label:"Consultar",unelevated:"",color:"primary",disable:!t.allowconsulta,loading:t.consultando},on:{click:t.actConsultar}}),t.$q.platform.is.mobile?t._e():e("q-btn",{staticClass:"q-ml-md",attrs:{flat:"",color:"primary",icon:"clear",label:t.$q.platform.is.mobile?"":"Limpar"},on:{click:t.actClear}})],1)],1),t.rows&&t.rows.length>0&&!t.loading?e("div",{staticClass:"q-mt-md",class:t.$q.platform.is.mobile?"q-px-sm":""},[e("div",{staticClass:"text-h6 q-ml-xs q-mb-sm"},[t._v("\r\n            Notas encontradas\r\n          ")]),t._l(t.rows,(function(a,r){return e("q-card",{directives:[{name:"ripple",rawName:"v-ripple"}],key:"nota"+r,staticClass:"bg-white q-mb-md cursor-pointer",attrs:{flat:"",bordered:"",clickable:""},on:{click:function(e){return t.actRastrear(a.notachave)}}},[e("q-card-section",[e("div",{staticClass:"row text-body"},[e("div",{staticClass:"col-7 text-weight-bold",staticStyle:{"font-size":"1rem"}},[t._v("\r\n                  NF-e: "+t._s(t.$helpers.formatMilhar(a.notanumero))+" - Série: "+t._s(t.$helpers.padLeftZero(a.notaserie,3))+"\r\n                ")]),e("div",{staticClass:"col-5 text-right text-body"},[t._v("\r\n                  Coleta: "+t._s(a.idcoleta?t.$helpers.formatMilhar(a.idcoleta):"?")+"\r\n                ")]),e("div",{staticClass:"col-12 text-caption"},[t._v("\r\n                  "+t._s(a.notachave)+"\r\n                ")])])]),e("q-separator"),e("q-card-section",{staticClass:"q-py-xs"},[e("div",{staticClass:"text-caption"},[t._v("Emitente")]),e("div",{staticClass:"row"},[e("div",{staticClass:"col-12 text-weight-bold"},[t._v("\r\n                  "+t._s(a.remetentenome)+"\r\n                ")]),e("div",{staticClass:"col-12"},[t._v("\r\n                  CNPJ: "+t._s(t.$helpers.mascaraDocCPFCNPJ(a.remetentecnpj))+"\r\n                ")])])]),e("q-card-section",[e("div",{staticClass:"text-caption"},[t._v("Destinatário")]),e("div",{staticClass:"row"},[e("div",{staticClass:"col-12 text-weight-bold"},[t._v("\r\n                  "+t._s(a.destinatarionome)+"\r\n                ")]),e("div",{staticClass:"col-12"},[t._v("\r\n                  CNPJ: "+t._s(t.$helpers.mascaraDocCPFCNPJ(a.destinatariocnpj))+"\r\n                ")])])]),e("q-card-actions",[e("q-btn",{staticClass:"full-width",attrs:{unelevated:"",label:"Rastrear",icon:"travel_explore",color:"accent"}})],1)],1)}))],2):t._e()],1),e("q-page-sticky",{attrs:{position:"top",expand:""}},[e("q-toolbar",{staticClass:"bg-white text-primary shadow-up-21"},[e("q-btn",{attrs:{flat:"",dense:"",round:"","aria-label":"Menu",icon:"menu"},on:{click:function(a){return t.$store.dispatch("homedashboard/togglemenu")}}}),e("q-btn",{attrs:{flat:"",round:"",icon:"arrow_back"},on:{click:function(a){return t.$router.go(-1)}}}),t.$q.platform.is.mobile?t._e():e("q-separator",{attrs:{vertical:"",inset:"",spaced:""}}),e("q-toolbar-title",[t._v("Rastreamento de carga")]),e("q-btn",{attrs:{flat:"",rounded:"",icon:"clear",label:t.$q.platform.is.mobile?"":"Limpar"},on:{click:t.actClear}})],1)],1)],1)])],1)},o=[],n=(e("ac6a"),e("cadf"),e("06db"),e("456d"),e("a34a")),s=e.n(n),c=(e("96cf"),e("c973")),l=e.n(c),i=e("e908"),u=e("1421"),d=e("38fe"),p={name:"usuario.meuperfil",components:{},data:function(){var t=e("492b"),a=new u["a"],r=new i["a"],o=new d["a"];return{lottiessearchdoc:t,usuario:a,cnpjstart:null,rows:null,consultatipo:"chave",consultanumero:"",consultachave:"",consultanfe:o,error:null,consultanferet:{ok:!1},dataset:r,loading:!1,consultando:!1}},activated:function(){},deactivated:function(){},mounted:function(){var t=this;return l()(s.a.mark((function a(){return s.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.init();case 2:t.allowconsulta&&t.actConsultar();case 3:case"end":return a.stop()}}),a)})))()},computed:{usuariologado:function(){var t=this,a=null;return t.$store.state.usuario.logado&&t.$store.state.usuario.user&&(a=t.$store.state.usuario.user),a},allowconsulta:function(){var t=this;try{if(["numero","coleta"].indexOf(t.consultatipo)>=0){if(!t.consultanumero||""===t.consultanumero)throw new Error("Número vazia");if(!(parseInt(t.consultanumero)>0))throw new Error("Número inválido")}if("chave"===t.consultatipo){if(!t.consultachave||""===t.consultachave)throw new Error("Chave vazia");if(!t.consultanferet.ok)throw new Error(t.consultanferet.msg)}return!0}catch(a){return!1}}},methods:{actRastrear:function(t){var a=this;return l()(s.a.mark((function e(){return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a.$router.push({name:"rastrear",params:{chave:t}});case 1:case"end":return e.stop()}}),e)})))()},statusToConfig:function(t){var a={icon:"radio_button_unchecked",color:"grey-5",textcolor:"white"};switch(t){case"1":a.icon="task_alt",a.color="positive";break;case"2":a.icon="swipe_right_alt",a.color="orange";break;case"3":a.icon="error",a.color="red";break}return a},init:function(){var t=this;return l()(s.a.mark((function a(){var e;return s.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e=t,a.prev=1,e.loading=!0,e.error=null,e.consultaret={ok:!1},e.usuariologado){a.next=7;break}throw new Error("Nenhum usuário logado");case 7:if(e.usuariologado.permitecoletasver){a.next=9;break}throw new Error("Sem permissão de acesso");case 9:return e.$route.query.cnpj&&""!==e.$route.query.cnpj&&(e.cnpjstart=e.$route.query.cnpj),e.$route.query.chave&&""!==e.$route.query.chave&&(e.consultatipo="chave",e.consultachave=e.$route.query.chave,e.onInputChave(e.consultachave)),e.usuario.limpardados(),e.dataset.limpardados(),a.next=15,e.refreshData();case 15:a.next=21;break;case 17:a.prev=17,a.t0=a["catch"](1),e.loading=!1,e.error=a.t0.message;case 21:e.loading=!1;case 22:case"end":return a.stop()}}),a,null,[[1,17]])})))()},refreshData:function(){var t=this;return l()(s.a.mark((function a(){var e,r,o;return s.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e=t,a.next=3,e.usuario.meuUsuario();case 3:if(r=a.sent,r.ok){a.next=9;break}return e.loading=!1,o=e.$helpers.showDialog(r),a.next=9,o.then((function(){}));case 9:case"end":return a.stop()}}),a)})))()},actClear:function(){var t=this;return l()(s.a.mark((function a(){var e;return s.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:e=t,e.rows=null,e.dataset.limpardados(),e.consultanumero=null,e.consultachave=null;case 5:case"end":return a.stop()}}),a)})))()},onInputChave:function(t){var a=this;return l()(s.a.mark((function e(){var r;return s.a.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=a,r.consultanfe.setChave(t),e.next=4,r.consultanfe.isValid();case 4:r.consultanferet=e.sent;case 5:case"end":return e.stop()}}),e)})))()},actConsultar:function(){var t=this;return l()(s.a.mark((function a(){var e,r,o,n;return s.a.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(e=t,e.consultando=!0,r=e.$helpers.dialogProgress(e,"Consultando notas, aguarde!","Rastreamento de carga"),a.prev=3,!(["numero","coleta"].indexOf(e.consultatipo)>=0)){a.next=9;break}if(e.consultanumero&&""!==e.consultanumero){a.next=7;break}throw new Error("Número vazia");case 7:if(parseInt(e.consultanumero)>0){a.next=9;break}throw new Error("Número inválido");case 9:if("chave"!==e.consultatipo){a.next=14;break}if(e.consultachave&&""!==e.consultachave){a.next=12;break}throw new Error("Chave vazia");case 12:if(e.consultanferet.ok){a.next=14;break}throw new Error(e.consultanferet.msg);case 14:return e.dataset.readPropsTable(),e.$q.platform.is.mobile&&(e.dataset.pagination.rowsPerPage=50),delete e.dataset.notanumero,delete e.dataset.idcoleta,delete e.dataset.chave,"chave"===e.consultatipo&&(e.dataset.chave=e.consultachave),"numero"===e.consultatipo&&(e.dataset.notanumero=e.consultanumero),"coleta"===e.consultatipo&&(e.dataset.idcoleta=e.consultanumero),e.dataset.orderby=null,e.orderbylist&&(o=Object.keys(e.orderbylist).length,o>0&&(e.dataset.orderby=e.orderbylist)),a.next=26,e.dataset.fetch();case 26:n=a.sent,n.ok?e.rows=e.dataset.itens:(e.msgError=n.msg,e.consultaret={ok:!1,msg:n.msg}),a.next=35;break;case 30:a.prev=30,a.t0=a["catch"](3),console.error(a.t0),e.$helpers.showDialog({ok:!1,msg:a.t0.message},!0),e.consultaret={ok:!1,msg:a.t0.message};case 35:return a.prev=35,r.hide(),e.consultando=!1,a.finish(35);case 39:case"end":return a.stop()}}),a,null,[[3,30,35,39]])})))()}}},m=p,h=e("2877"),v=e("9989"),f=e("54e1"),b=e("f09f"),w=e("a370"),g=e("9f0a"),q=e("27f9"),x=e("0016"),k=e("9c40"),C=e("eb85"),_=e("4b7e"),y=e("de5e"),$=e("65c6"),N=e("6ac5"),P=e("714f"),E=e("eebe"),Q=e.n(E),j=Object(h["a"])(m,r,o,!1,null,null,null);a["default"]=j.exports;Q()(j,"components",{QPage:v["a"],QBanner:f["a"],QCard:b["a"],QCardSection:w["a"],QOptionGroup:g["a"],QInput:q["a"],QIcon:x["a"],QBtn:k["a"],QSeparator:C["a"],QCardActions:_["a"],QPageSticky:y["a"],QToolbar:$["a"],QToolbarTitle:N["a"]}),Q()(j,"directives",{Ripple:P["a"]})}}]);